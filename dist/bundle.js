(()=>{"use strict";var e={970:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FONT_TYPE_BOLD=t.FONT_TYPE_SEMIBOLD=t.FONT_TYPE_MEDIUM=t.TEXT_COLOR=t.BLANK_COLOR=t.BOTTOM_EDGE=t.LEFT_EDGE=t.TOP_EDGE=t.RIGHT_EDGE=t.BLANK_PADDING=t.BLANK_SIZE_X=t.BLANK_SIZE_Y=void 0,t.BLANK_SIZE_Y=3508,t.BLANK_SIZE_X=2480,t.BLANK_PADDING=100,t.RIGHT_EDGE=t.BLANK_SIZE_X-t.BLANK_PADDING,t.TOP_EDGE=t.BLANK_PADDING,t.LEFT_EDGE=t.BLANK_PADDING,t.BOTTOM_EDGE=t.BLANK_SIZE_Y-t.BLANK_PADDING,t.BLANK_COLOR="#f2f2f2",t.TEXT_COLOR="#191b23",t.FONT_TYPE_MEDIUM="medium",t.FONT_TYPE_SEMIBOLD="semibold",t.FONT_TYPE_BOLD="bold"},607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRequestBlank=void 0;const a=r(680);var o=r(680);Object.defineProperty(t,"createRequestBlank",{enumerable:!0,get:function(){return o.createRequestBlank}}),e.exports={createRequestBlank:a.createRequestBlank}},680:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createRequestBlank=void 0;const o=a(r(441)),i=a(r(17)),s=r(970),n=r(884),l=r(124),_={from:s.TOP_EDGE,to:s.TOP_EDGE+100,type:s.TOP_EDGE+800,clarification:s.TOP_EDGE+1e3,date:s.BOTTOM_EDGE};t.createRequestBlank=async function(e){const t=(0,l.capitalizeFirstLetter)(new Intl.DateTimeFormat("ru-RU",{dateStyle:"full"}).format(e.date)),[r,a,u,f,E]=await Promise.all([(0,n.processText)(`От ${e.from}`),(0,n.processText)(`Для ${e.to}`),(0,n.processText)((0,l.capitalizeFirstLetter)("test"),{fontFamily:s.FONT_TYPE_BOLD,svgOptions:{fontSize:100}}),(0,n.processText)(e.clarification,{multiline:{maxWidth:s.BLANK_SIZE_X-2*s.BLANK_PADDING}}),(0,n.processText)(t)]),c=Number(r.meta.width)>Number(a.meta.width)?Number(r.meta.width):Number(a.meta.width),p=await(0,o.default)(i.default.resolve("./assets/images/arms.png")).resize(2e3,2e3).toBuffer();return await(0,o.default)({create:{width:s.BLANK_SIZE_X,height:s.BLANK_SIZE_Y,channels:4,background:s.BLANK_COLOR}}).composite([{input:p},{input:r.buffer,top:_.from,left:Math.floor(s.RIGHT_EDGE-c)},{input:a.buffer,top:_.to,left:Math.floor(s.RIGHT_EDGE-c)},{input:u.buffer,top:_.type,left:Math.floor(s.RIGHT_EDGE/2-Number(u.meta.width)/2)},{input:f.buffer,top:_.clarification,left:s.LEFT_EDGE},{input:E.buffer,top:Math.floor(_.date-Number(E.meta.height)),left:s.LEFT_EDGE}])}},124:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.capitalizeFirstLetter=void 0,t.capitalizeFirstLetter=e=>e.charAt(0).toUpperCase()+e.slice(1)},884:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.processText=t.TTSVG=void 0;const o=a(r(441)),i=a(r(17)),s=r(970),n=r(882);t.TTSVG={[s.FONT_TYPE_MEDIUM]:n.loadSync(i.default.resolve("./assets/fonts/OpenSans-Medium.ttf")),[s.FONT_TYPE_SEMIBOLD]:n.loadSync(i.default.resolve("./assets/fonts/OpenSans-SemiBold.ttf")),[s.FONT_TYPE_BOLD]:n.loadSync(i.default.resolve("./assets/fonts/OpenSans-Bold.ttf"))};const l={x:0,y:0,fontSize:80,anchor:"top",attributes:{fill:s.TEXT_COLOR,stroke:"transparent",kek:"mek"}};t.processText=async(e,r={})=>{const{fontFamily:a=s.FONT_TYPE_MEDIUM,svgOptions:i={},multiline:n={}}=r,_=t.TTSVG[a];let u=Buffer.from(_.getSVG(e,{...l,...i})),f=(0,o.default)(u),E=await f.metadata();const c=Number(E.width);if(n.maxWidth&&c>n.maxWidth){const{maxWidth:t}=n,r=((e,t,r)=>{var a=t/e.length;let o=[],i=0;for(var s=0;s<Math.ceil(t/r);s++){let t="",s=0;for(;!(s>r)&&e[i];)t+=e[i],i++,s+=a;o.push(t.trim())}return o.filter(Boolean)})(e,c,t),a=Number(E.height),s=r.length;if(console.log(s,JSON.stringify(r)),!r)throw new Error("Could not split text for multiple lines");const p=r.map(((e,t)=>({input:Buffer.from(_.getSVG(e,{...l,...i})),left:0,top:a*t})));f=(0,o.default)({create:{height:a*s,width:t+50,channels:4,background:{r:255,g:255,b:255,alpha:0}}}).composite(p).png(),E=await f.metadata(),u=await f.clone().toBuffer()}return{image:f,buffer:u,meta:E}}},441:e=>{e.exports=require("sharp")},882:e=>{e.exports=require("text-to-svg")},17:e=>{e.exports=require("path")}},t={},r=function r(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,r),i.exports}(607),a=exports;for(var o in r)a[o]=r[o];r.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();