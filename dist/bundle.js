(()=>{"use strict";var e={970:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ASSETS_DIR=t.FONT_TYPE_BOLD=t.FONT_TYPE_SEMIBOLD=t.FONT_TYPE_MEDIUM=t.TEXT_COLOR=t.BLANK_COLOR=t.BOTTOM_EDGE=t.LEFT_EDGE=t.TOP_EDGE=t.RIGHT_EDGE=t.BLANK_PADDING=t.BLANK_SIZE_X=t.BLANK_SIZE_Y=void 0;const o=a(r(17));t.BLANK_SIZE_Y=3508,t.BLANK_SIZE_X=2480,t.BLANK_PADDING=100,t.RIGHT_EDGE=t.BLANK_SIZE_X-t.BLANK_PADDING,t.TOP_EDGE=t.BLANK_PADDING,t.LEFT_EDGE=t.BLANK_PADDING,t.BOTTOM_EDGE=t.BLANK_SIZE_Y-t.BLANK_PADDING,t.BLANK_COLOR="#f2f2f2",t.TEXT_COLOR="#191b23",t.FONT_TYPE_MEDIUM="medium",t.FONT_TYPE_SEMIBOLD="semibold",t.FONT_TYPE_BOLD="bold",t.ASSETS_DIR=o.default.resolve(__dirname,"assets")},607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRequestBlank=void 0;const a=r(680);var o=r(680);Object.defineProperty(t,"createRequestBlank",{enumerable:!0,get:function(){return o.createRequestBlank}}),e.exports={createRequestBlank:a.createRequestBlank}},680:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createRequestBlank=void 0;const o=a(r(441)),i=a(r(17)),l=r(970),n=r(884),s=r(124),_={from:l.TOP_EDGE,to:l.TOP_EDGE+100,type:l.TOP_EDGE+800,clarification:l.TOP_EDGE+1e3,withRespect:l.BOTTOM_EDGE-100,date:l.BOTTOM_EDGE};t.createRequestBlank=async function(e){const{blankType:t="default"}=e,r=(0,s.capitalizeFirstLetter)(new Intl.DateTimeFormat("ru-RU",{dateStyle:"full"}).format(e.date)),[a,f,u,E,p,T]=await Promise.all([(0,n.processText)(e.from),(0,n.processText)(e.to),(0,n.processText)((0,s.capitalizeFirstLetter)(e.type),{fontFamily:l.FONT_TYPE_BOLD,svgOptions:{fontSize:100}}),(0,n.processText)(e.clarification,{multiline:{maxWidth:l.BLANK_SIZE_X-2*l.BLANK_PADDING}}),(0,n.processText)(e.withRespect||" "),(0,n.processText)(r)]),c=Number(a.meta.width)>Number(f.meta.width)?Number(a.meta.width):Number(f.meta.width),d=await(0,o.default)(i.default.resolve(l.ASSETS_DIR,`images/${t}.png`)).resize(2e3,2e3).toBuffer(),D=await(0,o.default)(i.default.resolve(l.ASSETS_DIR,"images/main_stamp.png")).toBuffer(),O=await(0,o.default)(i.default.resolve(l.ASSETS_DIR,"images/blank-starter.jpg")).resize({width:l.BLANK_SIZE_X,height:l.BLANK_SIZE_Y}).toBuffer();return await(0,o.default)({create:{width:l.BLANK_SIZE_X,height:l.BLANK_SIZE_Y,channels:4,background:l.BLANK_COLOR}}).composite([{input:O,top:0,left:0},{input:d},{input:D,top:l.BOTTOM_EDGE-950-50,left:l.RIGHT_EDGE-950-50},{input:a.buffer,top:_.from,left:Math.floor(l.RIGHT_EDGE-c)},{input:f.buffer,top:_.to,left:Math.floor(l.RIGHT_EDGE-c)},{input:u.buffer,top:_.type,left:Math.floor(l.RIGHT_EDGE/2-Number(u.meta.width)/2)},{input:E.buffer,top:_.clarification,left:l.LEFT_EDGE},{input:p.buffer,top:Math.floor(_.withRespect-Number(p.meta.height)),left:l.LEFT_EDGE},{input:T.buffer,top:Math.floor(_.date-Number(T.meta.height)),left:l.LEFT_EDGE}])}},124:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.capitalizeFirstLetter=void 0,t.capitalizeFirstLetter=(e=" ")=>e.charAt(0).toUpperCase()+e.slice(1)},884:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.processText=t.TTSVG=void 0;const o=a(r(441)),i=a(r(17)),l=r(970),n=r(882);t.TTSVG={[l.FONT_TYPE_MEDIUM]:n.loadSync(i.default.resolve(l.ASSETS_DIR,"fonts/OpenSans-Medium.ttf")),[l.FONT_TYPE_SEMIBOLD]:n.loadSync(i.default.resolve(l.ASSETS_DIR,"fonts/OpenSans-SemiBold.ttf")),[l.FONT_TYPE_BOLD]:n.loadSync(i.default.resolve(l.ASSETS_DIR,"fonts/OpenSans-Bold.ttf"))};const s={x:0,y:0,fontSize:80,anchor:"top",attributes:{fill:l.TEXT_COLOR,stroke:"transparent",kek:"mek"}};t.processText=async(e=" ",r={})=>{const{fontFamily:a=l.FONT_TYPE_MEDIUM,svgOptions:i={},multiline:n={}}=r,_=t.TTSVG[a];let f=Buffer.from(_.getSVG(e,{...s,...i})),u=(0,o.default)(f),E=await u.metadata();const p=Number(E.width);if(n.maxWidth&&p>n.maxWidth){const{maxWidth:t}=n,r=((e,t,r)=>{let a=t/e.length,o=Math.floor(r/a)-3,i=[],l=e.split(" "),n=0;for(let e=0;e<l.length;e++){let t=l[e];if(i[n]||(i[n]=""),t.length>o){const e=t.split(""),r=[];for(let t=0;t<e.length;t+=o){var s=e.slice(t,t+o).join("");r.push(s)}const a=r.length;i=[...i,...r],n+=a}else i[n].length+t.length+1<=o?i[n]+=`${i[n]?" ":""}${t}`:(n++,e--)}return i=i.filter(Boolean),i})(e,p,t),a=Number(E.height),l=r.length;if(!r)throw new Error("Could not split text for multiple lines");const T=r.map(((e,t)=>({input:Buffer.from(_.getSVG(e,{...s,...i})),left:0,top:a*t})));u=(0,o.default)({create:{height:a*l,width:t,channels:4,background:{r:255,g:255,b:255,alpha:0}}}).composite(T).png(),E=await u.metadata(),f=await u.clone().toBuffer()}return{image:u,buffer:f,meta:E}}},441:e=>{e.exports=require("sharp")},882:e=>{e.exports=require("text-to-svg")},17:e=>{e.exports=require("path")}},t={},r=function r(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,r),i.exports}(607),a=exports;for(var o in r)a[o]=r[o];r.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();